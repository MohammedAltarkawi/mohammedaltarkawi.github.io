{"version":3,"file":"GenericStateModel.js","names":["GenericJSONModel","JSONModel","constructor","data","super","this","_setData","oData","bMerge","setData","_checkUpdate","_observeFunctions","getState","getContext","key","prototype","apply","arguments","allData","bHooked","Object","getOwnPropertyNames","getPrototypeOf","forEach","sAttr","sVal","funcBefore","funcCheckUpdate","bind","ret","bFirstCall","_len","length","args","Array","_key","checkUpdate"],"sources":["GenericStateModel.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unsafe-function-type */\r\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\r\n/* eslint-disable @typescript-eslint/no-unsafe-return */\r\n/* eslint-disable @typescript-eslint/no-unsafe-call */\r\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\r\n/* eslint-disable @typescript-eslint/no-unsafe-argument */\r\n/* eslint-disable @typescript-eslint/ban-ts-comment */\r\n/* eslint-disable prefer-rest-params */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport Context from 'sap/ui/model/Context';\r\nimport JSONModel from 'sap/ui/model/json/JSONModel';\r\n\r\n/**\r\n * @namespace @namespace tvc.ui5.configurator\r\n */\r\nexport default class GenericJSONModel<T> extends JSONModel {\r\n    _testType: any;\r\n\r\n    constructor(data: T) {\r\n        super();\r\n        this._setData(data);\r\n    }\r\n\r\n    public _setData(oData: T, bMerge?: boolean): void {\r\n        this.setData(<any>oData, bMerge);\r\n\r\n        this._checkUpdate();\r\n        this._observeFunctions();\r\n    }\r\n\r\n    public getState(): T {\r\n        return (this as any).oData as T;\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    public getContext(key: string): Context {\r\n        //@ts-ignore\r\n        return JSONModel.prototype.getContext.apply(this, arguments);\r\n    }\r\n\r\n    private _observeFunctions() {\r\n        //small trick: we are calling a check update after every single function (instead of after every single attribute change)\r\n        //as we are 100% ensuring, that nobody is adjusting the values..\r\n        const allData = (this as any).oData as T;\r\n        let bHooked = false;\r\n\r\n        Object.getOwnPropertyNames(Object.getPrototypeOf((this as any).oData)).forEach(sAttr => {\r\n            const sVal = (<any>allData)[sAttr];\r\n            if (typeof sVal === 'function') {\r\n                const funcBefore: Function = sVal;\r\n                const funcCheckUpdate = this._checkUpdate.bind(this);\r\n                (<any>allData)[sAttr] = function (...args: any[]) {\r\n                    let ret: any = null;\r\n                    const bFirstCall = bHooked === false;\r\n                    bHooked = true;\r\n\r\n                    try {\r\n                        ret = funcBefore.apply(this, args);\r\n                    } finally {\r\n                        bHooked = bFirstCall === true ? false : true;\r\n                    }\r\n                    if (bFirstCall === true) {\r\n                        funcCheckUpdate();\r\n                    }\r\n                    return ret;\r\n                };\r\n            }\r\n        });\r\n    }\r\n\r\n    public _checkUpdate() {\r\n        (<any>this).checkUpdate(false, true);\r\n    }\r\n}\r\n"],"mappings":"oFAee,MAAMA,UAA4BC,EAG7CC,YAAYC,GACRC,QACAC,KAAKC,SAASH,EAClB,CAEOG,SAASC,EAAUC,GACtBH,KAAKI,QAAaF,EAAOC,GAEzBH,KAAKK,eACLL,KAAKM,mBACT,CAEOC,WACH,OAAQP,KAAaE,KACzB,CAGOM,WAAWC,GAEd,OAAOb,EAAUc,UAAUF,WAAWG,MAAMX,KAAMY,UACtD,CAEQN,oBAGJ,MAAMO,EAAWb,KAAaE,MAC9B,IAAIY,EAAU,MAEdC,OAAOC,oBAAoBD,OAAOE,eAAgBjB,KAAaE,QAAQgB,QAAQC,IAC3E,MAAMC,EAAaP,EAASM,GAC5B,UAAWC,IAAS,WAAY,CAC5B,MAAMC,EAAuBD,EAC7B,MAAME,EAAkBtB,KAAKK,aAAakB,KAAKvB,MACzCa,EAASM,GAAS,WACpB,IAAIK,EAAW,KACf,MAAMC,EAAaX,IAAY,MAC/BA,EAAU,KAEV,IAAI,QAAAY,EAAAd,UAAAe,OAL6BC,EAAI,IAAAC,MAAAH,GAAAI,EAAA,EAAAA,EAAAJ,EAAAI,IAAA,CAAJF,EAAIE,GAAAlB,UAAAkB,EAAA,CAMjCN,EAAMH,EAAWV,MAAMX,KAAM4B,EACjC,CAAC,QACGd,EAAUW,IAAe,KAAO,MAAQ,IAC5C,CACA,GAAIA,IAAe,KAAM,CACrBH,GACJ,CACA,OAAOE,CACX,CACJ,GAER,CAEOnB,eACGL,KAAM+B,YAAY,MAAO,KACnC,EACH,OAAApC,CAAA","ignoreList":[]}